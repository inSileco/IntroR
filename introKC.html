<!DOCTYPE html>
<html>
  <head>
    <title>Introduction to R</title>
    <meta charset="utf-8">
    <meta name="author" content="Marie-Hélène Brice &amp; Kevin Cazelles" />
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/academicons-1.8.1/css/academicons.min.css">
    <link rel="stylesheet" href="inSileco.css" type="text/css" />
    <link rel="stylesheet" href="inSileco-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">










---
# Aims

&lt;br&gt;

### &amp;nbsp; Better ideas about what R actually is
### &amp;nbsp; Better ideas about what R can do
### &amp;nbsp; Better ideas about the topics covered

---
# Outline

### &amp;nbsp; &lt;i class="fa fa-commenting-o" aria-hidden="true"&gt;&lt;/i&gt; R? ~10min
### &amp;nbsp; &lt;i class="fa fa-wrench" aria-hidden="true"&gt;&lt;/i&gt; Data manipulations ~1h15min
### &amp;nbsp; &lt;i class="fa fa-bar-chart" aria-hidden="true"&gt;&lt;/i&gt; Data visualization (part1) ~30min
### &amp;nbsp; &lt;i class="fa fa-cutlery" aria-hidden="true"&gt;&lt;/i&gt; Lunch break 12pm
### &amp;nbsp; &lt;i class="fa fa-bar-chart" aria-hidden="true"&gt;&lt;/i&gt; Data visualization (part2) ~30min
### &amp;nbsp; &lt;i class="fa fa-map" aria-hidden="true"&gt;&lt;/i&gt; mapping ~ 1h30
### &amp;nbsp; &lt;i class="fa fa-coffee" aria-hidden="true"&gt;&lt;/i&gt; *coffee break* 3pm
### &amp;nbsp; &lt;i class="fa fa-sitemap" aria-hidden="true"&gt;&lt;/i&gt; ordination ~1h30



---
class: inverse, center, middle

# R?

## &lt;i class="fa fa-commenting-o" aria-hidden="true"&gt;&lt;/i&gt;


---
# R

&lt;br&gt;

&gt; R is a programming language and free software environment for statistical computing and graphics [...].

&lt;br&gt;

&gt; The R language is widely used among statisticians and data miners for developing statistical software and data analysis.

[R (programming language) - Wikipedia](https://en.wikipedia.org/wiki/R_(programming_language)


---
# R is popular

.center[![:scale 85%](images/redmonk.png)]

[Python](https://www.python.org/) / [Julia](https://julialang.org/)


---
# R is popular among Biological Sciences

### For instance

1. Ecologists
2. Bioinformatics [(Bioconductor)](https://www.bioconductor.org/)
3. Medicine [&lt;i class="fa fa-external-link" aria-hidden="true"&gt;&lt;/i&gt;](https://r-medicine.com/)

--

### Why?

1. An incredible tool for statistics
2. Fairly accessible for non-programmer people
3. A very high diversity of packages


---
# R is popular

.center[![:scale 72%](https://revolution-computing.typepad.com/.a/6a010534b1db25970b01b8d2594d25970c-800wi)]

[*CRAN now has 10,000 R packages* Revolutions. January, 2017](https://blog.revolutionanalytics.com/2017/01/cran-10000.html)

[MetaCRAN](https://www.r-pkg.org/) / [R Package Documentation](https://rdrr.io/)




---
# R, RStudio, Ropenscience?

### Main links

- [R project](https://www.r-project.org/)
- [CRAN](https://cran.r-project.org/)
- [RStudio](https://www.rstudio.com/)
- [rOpenSci](https://ropensci.org)

### Get reliable documentation

- [CRAN Manual &amp; Contributed](https://cran.r-project.org/)
- [bookdown](https://bookdown.org/)
- [RStudio](https://www.rstudio.com/)
  - [Cheat Sheets](https://www.rstudio.com/resources/cheatsheets/)
  - [Webinars](https://resources.rstudio.com/webinars)
- [QCBS](https://qcbsrworkshops.github.io/Workshops/)
- [DataCarpentery](https://datacarpentry.org/R-genomics/index.html)
- [&lt;i class="fa fa-stack-overflow" aria-hidden="true"&gt;&lt;/i&gt;](https://stackoverflow.com/questions/tagged/r)




---
class: inverse, center, middle

# Data manipulation

## &lt;i class="fa fa-wrench" aria-hidden="true"&gt;&lt;/i&gt;



---
# Let's start
&lt;br&gt;

- Open R console / R GUI / RStudio / ...

--

```R
getwd()
setwd("pasth2workingdirectory")
```

--

- Install the following packages

```R
install.packages(c("tidyverse", "sf", "raster", "mapview", "vegan", "ade4",
  "scales", "Rcolorbrewer"))
```

---
# R's principles
&lt;br&gt;


### 1. Everything in R is an object

### 2. Everything that happens in R is a function call

### 3. Interfaces to other software are part of R.


[Extending-R by Chambers](https://www.crcpress.com/Extending-R/Chambers/p/book/9781498775717)

---
# Everything in R is an object
&lt;br&gt;


```r
2
# [1] 2
```

--


```r
class(2)
# [1] "numeric"
```
--


```r
class("A")
# [1] "character"
class(library)
# [1] "function"
plot
# function (x, y, ...) 
# UseMethod("plot")
# &lt;bytecode: 0x7faeb1323440&gt;
# &lt;environment: namespace:graphics&gt;
```

---
class: center
# Everything that happens in R is a function call
&lt;br&gt;

```R
class(2)
```
## &lt;i class="fa fa-arrow-circle-o-down" aria-hidden="true"&gt;&lt;/i&gt;

### `enter`

## &lt;i class="fa fa-arrow-circle-o-down" aria-hidden="true"&gt;&lt;/i&gt;


```
# [1] "numeric"
```


---
# Interfaces to other software are part of R
&lt;br&gt;

### Four examples among many others:

- [Rcpp](https://cran.r-project.org/web/packages/Rcpp/index.html)

- [Reticulate](https://rstudio.github.io/reticulate/index.html)

- [Rmarkdown](https://rmarkdown.rstudio.com/)

- [plotly](https://plot.ly/r/)

- [mapview](https://r-spatial.github.io/mapview/)


---
# Basic commands


```r
2+2
# [1] 4
2*3
# [1] 6
3&gt;2
# [1] TRUE
```

--


```r
let &lt;- LETTERS[1:10]
let2 = LETTERS[1:10]
let
#  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"
let2
#  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"
identical(let, let2)
# [1] TRUE
```

--

```r
let3 &lt;- sample(let, 5)
let2
#  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"
```

--

```R
# Functions documentation
?sample
```

---
# Vectors

**Create a vector**


```r
vec &lt;- c(2:5, 9:12, 2)
vec
# [1]  2  3  4  5  9 10 11 12  2
vec &gt; 4
# [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
```

--


```r
let
#  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"
length(let)
# [1] 10
```
--

**Subset a vector**


```r
let[1:2]
# [1] "A" "B"
let[c(1:2, 5:6)]
# [1] "A" "B" "E" "F"
let[-c(1,7)]
# [1] "B" "C" "D" "E" "F" "H" "I" "J"
vec[vec &gt; 4]
# [1]  5  9 10 11 12
let[let &gt; "C"]
# [1] "D" "E" "F" "G" "H" "I" "J"
```

---
# Matrices


```r
# use arguments
mat &lt;- matrix(1:18, ncol = 3, nrow = 6)
mat
#      [,1] [,2] [,3]
# [1,]    1    7   13
# [2,]    2    8   14
# [3,]    3    9   15
# [4,]    4   10   16
# [5,]    5   11   17
# [6,]    6   12   18
dim(mat)
# [1] 6 3
mat[1,2]
# [1] 7
```
--


```r
mat[1,]
# [1]  1  7 13
mat[,2]
# [1]  7  8  9 10 11 12
mat[2:4, 1:2]
#      [,1] [,2]
# [1,]    2    8
# [2,]    3    9
# [3,]    4   10
```

---
# Data frames

## &amp;nbsp; &amp;nbsp; &lt;i class="fa fa-question-circle-o" aria-hidden="true"&gt;&lt;/i&gt;

--


```r
df &lt;- data.frame(
  letter = let[1:5],
  val = vec[1:5],
  logic = vec[1:5]&gt;2
)
df
#   letter val logic
# 1      A   2 FALSE
# 2      B   3  TRUE
# 3      C   4  TRUE
# 4      D   5  TRUE
# 5      E   9  TRUE
class(df)
# [1] "data.frame"
dim(df)
# [1] 5 3
```

---
# Data frames


```r
df[1, 1]
# [1] A
# Levels: A B C D E
```


```r
df$letter
# [1] A B C D E
# Levels: A B C D E
df[,1]
# [1] A B C D E
# Levels: A B C D E
df[1]
#   letter
# 1      A
# 2      B
# 3      C
# 4      D
# 5      E
df[1:2]
#   letter val
# 1      A   2
# 2      B   3
# 3      C   4
# 4      D   5
# 5      E   9
```


```r
class(df$letter)
# [1] "factor"
class(df$val)
# [1] "numeric"
```

---
# Data frames
&lt;br&gt;


```r
library(datasets)
```

To see the list of available datasets:

```R
data()
```

To access the documentation of a particular dataset:

```R
?CO2
```


---
# Data frames


```r
library(datasets)
head(CO2)
# Grouped Data: uptake ~ conc | Plant
#   Plant   Type  Treatment conc uptake
# 1   Qn1 Quebec nonchilled   95   16.0
# 2   Qn1 Quebec nonchilled  175   30.4
# 3   Qn1 Quebec nonchilled  250   34.8
# 4   Qn1 Quebec nonchilled  350   37.2
# 5   Qn1 Quebec nonchilled  500   35.3
# 6   Qn1 Quebec nonchilled  675   39.2
names(CO2)
# [1] "Plant"     "Type"      "Treatment" "conc"      "uptake"
summary(CO2)
#      Plant             Type         Treatment       conc          uptake     
#  Qn1    : 7   Quebec     :42   nonchilled:42   Min.   :  95   Min.   : 7.70  
#  Qn2    : 7   Mississippi:42   chilled   :42   1st Qu.: 175   1st Qu.:17.90  
#  Qn3    : 7                                    Median : 350   Median :28.30  
#  Qc1    : 7                                    Mean   : 435   Mean   :27.21  
#  Qc3    : 7                                    3rd Qu.: 675   3rd Qu.:37.12  
#  Qc2    : 7                                    Max.   :1000   Max.   :45.50  
#  (Other):42
```

--


```r
CO2$Plant
#  [1] Qn1 Qn1 Qn1 Qn1 Qn1 Qn1 Qn1 Qn2 Qn2 Qn2 Qn2 Qn2 Qn2 Qn2 Qn3 Qn3 Qn3 Qn3 Qn3 Qn3 Qn3 Qc1
# [23] Qc1 Qc1 Qc1 Qc1 Qc1 Qc1 Qc2 Qc2 Qc2 Qc2 Qc2 Qc2 Qc2 Qc3 Qc3 Qc3 Qc3 Qc3 Qc3 Qc3 Mn1 Mn1
# [45] Mn1 Mn1 Mn1 Mn1 Mn1 Mn2 Mn2 Mn2 Mn2 Mn2 Mn2 Mn2 Mn3 Mn3 Mn3 Mn3 Mn3 Mn3 Mn3 Mc1 Mc1 Mc1
# [67] Mc1 Mc1 Mc1 Mc1 Mc2 Mc2 Mc2 Mc2 Mc2 Mc2 Mc2 Mc3 Mc3 Mc3 Mc3 Mc3 Mc3 Mc3
# Levels: Qn1 &lt; Qn2 &lt; Qn3 &lt; Qc1 &lt; Qc3 &lt; Qc2 &lt; Mn3 &lt; Mn2 &lt; Mn1 &lt; Mc2 &lt; Mc3 &lt; Mc1
```


---
# Lists


```r
mylist &lt;- list(CO2 = CO2, mymat = mat, mylet = let[1], awesome = "cool")
names(mylist)
# [1] "CO2"     "mymat"   "mylet"   "awesome"
mylist$awesome
# [1] "cool"
mylist[3:4]
# $mylet
# [1] "A"
# 
# $awesome
# [1] "cool"
```

--


```r
class(mylist[2])
# [1] "list"
class(mylist[[2]])
# [1] "matrix"
mylist[[2]]
#      [,1] [,2] [,3]
# [1,]    1    7   13
# [2,]    2    8   14
# [3,]    3    9   15
# [4,]    4   10   16
# [5,]    5   11   17
# [6,]    6   12   18
class(mylist[[2]][2,3])
# [1] "integer"
mylist[[2]][2,3]
# [1] 14
```


---
# For loops


```r
for (i in 1:4) {
  # actions
  print(i)
}
# [1] 1
# [1] 2
# [1] 3
# [1] 4
```


```r
for (j in LETTERS[1:5]) {
  print(j)
}
# [1] "A"
# [1] "B"
# [1] "C"
# [1] "D"
# [1] "E"
```


```r
for (i in c(1,4,6)) {
  print(i)
}
# [1] 1
# [1] 4
# [1] 6
```


---
# Logical conditions &amp;nbsp; &gt; &amp;nbsp; &gt;= &amp;nbsp; &lt; &amp;nbsp; &lt;= &amp;nbsp; == &amp;nbsp; !=

--


```r
vec &lt;- c(2:5, 9:12, 2)
vec
# [1]  2  3  4  5  9 10 11 12  2
vec[1] &gt; 4
# [1] FALSE
vec &gt; 4
# [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
```

--

`if` ... `else` ...


```r
for (i in vec) {
  if (i &lt;= 5) {
   # actions
   print(i)
 } else {
   print("nope")
 }
}
# [1] 2
# [1] 3
# [1] 4
# [1] 5
# [1] "nope"
# [1] "nope"
# [1] "nope"
# [1] "nope"
# [1] 2
```




---
class: inverse, center, middle

# Questions?

## &lt;i class="fa fa-question-circle-o" aria-hidden="true"&gt;&lt;/i&gt;


---
# Tidyverse - a metapackage

&lt;br&gt;



```r
library(tidyverse)
```

### &lt;i class="fa fa-wrench" aria-hidden="true"&gt;&lt;/i&gt; A great tool belt for data science [&lt;i class="fa fa-external-link" aria-hidden="true"&gt;&lt;/i&gt;](https://www.tidyverse.org/)

--

- &lt;i class="fa fa-check" aria-hidden="true"&gt;&lt;/i&gt; Pros:
  - well-documented, intuitive
  - efficient
  - very popular

- &lt;i class="fa fa-exclamation-triangle" aria-hidden="true"&gt;&lt;/i&gt;Cons:
  - an alternative way of doing the same manipulation things
  - prevents the user from learning programming basics



---
# Data manipulations
&lt;br&gt;

### &amp;nbsp; 1. Import data / read file(s) &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; get R object(s)
### &amp;nbsp; 2. Select / Filter &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; find the data of interest
### &amp;nbsp; 3. Join &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; combine data
### &amp;nbsp; 4. Mutate / Aggregate &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; create new data
### &amp;nbsp; 5. Cast and Melt &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; Format your data
### &amp;nbsp; 6. R object(s) &lt;i class="fa fa-arrow-circle-right" aria-hidden="true"&gt;&lt;/i&gt; Export data / write file(s)



---
# Read a file


```r
df2 &lt;- read.csv("data/environ.csv")
head(df2, 3)
#   dfs alt   slo flo pH har pho nit amm oxy bdo
# 1   3 934 6.176  84 79  45   1  20   0 122  27
# 2  22 932 3.434 100 80  40   2  20  10 103  19
# 3 102 914 3.638 180 83  52   5  22   5 105  35
class(df2)
# [1] "data.frame"
```
--


```r
df3 &lt;- read_csv("data/environ.csv")
head(df3, 3)
# # A tibble: 3 x 11
#     dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
# 1     3   934  6.18    84    79    45     1    20     0   122    27
# 2    22   932  3.43   100    80    40     2    20    10   103    19
# 3   102   914  3.64   180    83    52     5    22     5   105    35
class(df3)
# [1] "tbl_df"     "tbl"        "data.frame"
```

--

- `read.table()`
- [SQL in R](http://dept.stat.lsa.umich.edu/~jerrick/courses/stat701/notes/sql.html)
- [MongoDB in R](https://jeroen.github.io/mongolite/)
- [MariaDB](https://mariadb.com/kb/en/library/r-statistical-programming-using-mariadb-as-the-background-database/)

---
# Dataset 'doubs' in package 'ade4'
&lt;br&gt;


```r
library(ade4)
data(doubs)
# ?doubs
```

--


```r
class(doubs)
# [1] "list"
names(doubs)
# [1] "env"     "fish"    "xy"      "species"
head(doubs$env)
#   dfs alt   slo flo pH har pho nit amm oxy bdo
# 1   3 934 6.176  84 79  45   1  20   0 122  27
# 2  22 932 3.434 100 80  40   2  20  10 103  19
# 3 102 914 3.638 180 83  52   5  22   5 105  35
# 4 185 854 3.497 253 80  72  10  21   0 110  13
# 5 215 849 3.178 264 81  84  38  52  20  80  62
# 6 324 846 3.497 286 79  60  20  15   0 102  53
```


---
# Dataset 'doubs' in package 'ade4'
&lt;br&gt;


```r
as_tibble(doubs$env)
# # A tibble: 30 x 11
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27
#  2    22   932  3.43   100    80    40     2    20    10   103    19
#  3   102   914  3.64   180    83    52     5    22     5   105    35
#  4   185   854  3.50   253    80    72    10    21     0   110    13
#  5   215   849  3.18   264    81    84    38    52    20    80    62
#  6   324   846  3.50   286    79    60    20    15     0   102    53
#  7   268   841  4.20   400    81    88     7    15     0   111    22
#  8   491   792  3.26   130    81    94    20    41    12    70    81
#  9   705   752  2.56   480    80    90    30    82    12    72    52
# 10   990   617  4.61  1000    77    82     6    75     1   100    43
# # … with 20 more rows
```

---
# Piping

--


```r
res &lt;- as_tibble(data.frame(res = log(diff(exp(1:6)))))
res
# # A tibble: 5 x 1
#     res
#   &lt;dbl&gt;
# 1  1.54
# 2  2.54
# 3  3.54
# 4  4.54
# 5  5.54
```

--


```r
# library(magrittr)
res &lt;- 1:6 %&gt;% exp %&gt;% diff %&gt;% log %&gt;% as.data.frame(col.names = "res") %&gt;% as_tibble
res
# # A tibble: 5 x 1
#       .
#   &lt;dbl&gt;
# 1  1.54
# 2  2.54
# 3  3.54
# 4  4.54
# 5  5.54
```


---
# Select

--


```r
denv &lt;- as_tibble(doubs$env)
dim(denv)
# [1] 30 11
names(denv)
#  [1] "dfs" "alt" "slo" "flo" "pH"  "har" "pho" "nit" "amm" "oxy" "bdo"
head(denv, 20)
# # A tibble: 20 x 11
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27
#  2    22   932  3.43   100    80    40     2    20    10   103    19
#  3   102   914  3.64   180    83    52     5    22     5   105    35
#  4   185   854  3.50   253    80    72    10    21     0   110    13
#  5   215   849  3.18   264    81    84    38    52    20    80    62
#  6   324   846  3.50   286    79    60    20    15     0   102    53
#  7   268   841  4.20   400    81    88     7    15     0   111    22
#  8   491   792  3.26   130    81    94    20    41    12    70    81
#  9   705   752  2.56   480    80    90    30    82    12    72    52
# 10   990   617  4.61  1000    77    82     6    75     1   100    43
# 11  1234   483  3.74  1990    81    96    30   160     0   115    27
# 12  1324   477  2.83  2000    79    86     4    50     0   122    30
# 13  1436   450  3.09  2110    81    98     6    52     0   124    24
# 14  1522   434  2.56  2120    83    98    27   123     0   123    38
# 15  1645   415  1.79  2300    86    86    40   100     0   117    21
# 16  1859   375  3.04  1610    80    88    20   200     5   103    27
# 17  1985   348  1.79  2430    80    92    20   250    20   102    46
# 18  2110   332  2.20  2500    80    90    50   220    20   103    28
# 19  2246   310  1.79  2590    81    84    60   220    15   106    33
# 20  2477   286  2.20  2680    80    86    30   300    30   103    28
```

---
# Select


```r
head(denv[, c(1:2, 5)])
# # A tibble: 6 x 3
#     dfs   alt    pH
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1     3   934    79
# 2    22   932    80
# 3   102   914    83
# 4   185   854    80
# 5   215   849    81
# 6   324   846    79
head(denv[, c("dfs", "alt", "pH")])
# # A tibble: 6 x 3
#     dfs   alt    pH
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1     3   934    79
# 2    22   932    80
# 3   102   914    83
# 4   185   854    80
# 5   215   849    81
# 6   324   846    79
```

---
# Select


```r
denvS &lt;- denv %&gt;% select(dfs, alt, pH)
head(denvS)
# # A tibble: 6 x 3
#     dfs   alt    pH
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1     3   934    79
# 2    22   932    80
# 3   102   914    83
# 4   185   854    80
# 5   215   849    81
# 6   324   846    79
```


```r
denvS &lt;- denv %&gt;% select(alt, pH, dfs)
head(denvS)
# # A tibble: 6 x 3
#     alt    pH   dfs
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1   934    79     3
# 2   932    80    22
# 3   914    83   102
# 4   854    80   185
# 5   849    81   215
# 6   846    79   324
```


---
# Select


```r
head(denv[, -c(1:2, 5)])
# # A tibble: 6 x 8
#     slo   flo   har   pho   nit   amm   oxy   bdo
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1  6.18    84    45     1    20     0   122    27
# 2  3.43   100    40     2    20    10   103    19
# 3  3.64   180    52     5    22     5   105    35
# 4  3.50   253    72    10    21     0   110    13
# 5  3.18   264    84    38    52    20    80    62
# 6  3.50   286    60    20    15     0   102    53
# head(denv[, -c("dfs", "alt", "pH")]) won't work
```


```r
denv %&gt;% select(-dfs, -alt, -pH)
# # A tibble: 30 x 8
#      slo   flo   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1  6.18    84    45     1    20     0   122    27
#  2  3.43   100    40     2    20    10   103    19
#  3  3.64   180    52     5    22     5   105    35
#  4  3.50   253    72    10    21     0   110    13
#  5  3.18   264    84    38    52    20    80    62
#  6  3.50   286    60    20    15     0   102    53
#  7  4.20   400    88     7    15     0   111    22
#  8  3.26   130    94    20    41    12    70    81
#  9  2.56   480    90    30    82    12    72    52
# 10  4.61  1000    82     6    75     1   100    43
# # … with 20 more rows
```


---
# Filter


```r
denv$alt
#  [1] 934 932 914 854 849 846 841 792 752 617 483 477 450 434 415 375 348 332 310 286 262 254
# [23] 246 241 231 214 206 195 183 172
```

--


```r
denvF &lt;- denv %&gt;% dplyr::filter(alt &gt; 400)
denvF
# # A tibble: 15 x 11
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27
#  2    22   932  3.43   100    80    40     2    20    10   103    19
#  3   102   914  3.64   180    83    52     5    22     5   105    35
#  4   185   854  3.50   253    80    72    10    21     0   110    13
#  5   215   849  3.18   264    81    84    38    52    20    80    62
#  6   324   846  3.50   286    79    60    20    15     0   102    53
#  7   268   841  4.20   400    81    88     7    15     0   111    22
#  8   491   792  3.26   130    81    94    20    41    12    70    81
#  9   705   752  2.56   480    80    90    30    82    12    72    52
# 10   990   617  4.61  1000    77    82     6    75     1   100    43
# 11  1234   483  3.74  1990    81    96    30   160     0   115    27
# 12  1324   477  2.83  2000    79    86     4    50     0   122    30
# 13  1436   450  3.09  2110    81    98     6    52     0   124    24
# 14  1522   434  2.56  2120    83    98    27   123     0   123    38
# 15  1645   415  1.79  2300    86    86    40   100     0   117    21
```

---
# Filter
&lt;br&gt;


```r
denvF2 &lt;- denv %&gt;% dplyr::filter(alt &gt; 400 &amp; pH&gt;=80)
denvF2
# # A tibble: 11 x 11
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1    22   932  3.43   100    80    40     2    20    10   103    19
#  2   102   914  3.64   180    83    52     5    22     5   105    35
#  3   185   854  3.50   253    80    72    10    21     0   110    13
#  4   215   849  3.18   264    81    84    38    52    20    80    62
#  5   268   841  4.20   400    81    88     7    15     0   111    22
#  6   491   792  3.26   130    81    94    20    41    12    70    81
#  7   705   752  2.56   480    80    90    30    82    12    72    52
#  8  1234   483  3.74  1990    81    96    30   160     0   115    27
#  9  1436   450  3.09  2110    81    98     6    52     0   124    24
# 10  1522   434  2.56  2120    83    98    27   123     0   123    38
# 11  1645   415  1.79  2300    86    86    40   100     0   117    21
```

---
# Filter
&lt;br&gt;


```r
denvF3 &lt;- denv %&gt;% dplyr::filter(alt &gt; 600 | pH&gt;=82)
denvF3
# # A tibble: 14 x 11
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27
#  2    22   932  3.43   100    80    40     2    20    10   103    19
#  3   102   914  3.64   180    83    52     5    22     5   105    35
#  4   185   854  3.50   253    80    72    10    21     0   110    13
#  5   215   849  3.18   264    81    84    38    52    20    80    62
#  6   324   846  3.50   286    79    60    20    15     0   102    53
#  7   268   841  4.20   400    81    88     7    15     0   111    22
#  8   491   792  3.26   130    81    94    20    41    12    70    81
#  9   705   752  2.56   480    80    90    30    82    12    72    52
# 10   990   617  4.61  1000    77    82     6    75     1   100    43
# 11  1522   434  2.56  2120    83    98    27   123     0   123    38
# 12  1645   415  1.79  2300    86    86    40   100     0   117    21
# 13  3947   195  1.39  4320    83   100    74   400    30    81    45
# 14  4530   172  1.10  6900    82   109    65   160    10    82    44
```

---
# Filter
&lt;br&gt;

Selection + Filter

--


```r
denvF4 &lt;- denv %&gt;% select(dfs, alt, pH) %&gt;% dplyr::filter(alt &gt; 400 &amp; pH&gt;=80)
denvF4
# # A tibble: 11 x 3
#      dfs   alt    pH
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1    22   932    80
#  2   102   914    83
#  3   185   854    80
#  4   215   849    81
#  5   268   841    81
#  6   491   792    81
#  7   705   752    80
#  8  1234   483    81
#  9  1436   450    81
# 10  1522   434    83
# 11  1645   415    86
```


---
# Mutate
&lt;br&gt;

--


```r
denvM &lt;- denv %&gt;% mutate(pH2 = pH + 1)
denvM
# # A tibble: 30 x 12
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo   pH2
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27    80
#  2    22   932  3.43   100    80    40     2    20    10   103    19    81
#  3   102   914  3.64   180    83    52     5    22     5   105    35    84
#  4   185   854  3.50   253    80    72    10    21     0   110    13    81
#  5   215   849  3.18   264    81    84    38    52    20    80    62    82
#  6   324   846  3.50   286    79    60    20    15     0   102    53    80
#  7   268   841  4.20   400    81    88     7    15     0   111    22    82
#  8   491   792  3.26   130    81    94    20    41    12    70    81    82
#  9   705   752  2.56   480    80    90    30    82    12    72    52    81
# 10   990   617  4.61  1000    77    82     6    75     1   100    43    78
# # … with 20 more rows
```

---
# Mutate
&lt;br&gt;



```r
denvM2 &lt;- denv %&gt;% mutate(index = 2*nit + pho + amm)
denvM2
# # A tibble: 30 x 12
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo index
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27    41
#  2    22   932  3.43   100    80    40     2    20    10   103    19    52
#  3   102   914  3.64   180    83    52     5    22     5   105    35    54
#  4   185   854  3.50   253    80    72    10    21     0   110    13    52
#  5   215   849  3.18   264    81    84    38    52    20    80    62   162
#  6   324   846  3.50   286    79    60    20    15     0   102    53    50
#  7   268   841  4.20   400    81    88     7    15     0   111    22    37
#  8   491   792  3.26   130    81    94    20    41    12    70    81   114
#  9   705   752  2.56   480    80    90    30    82    12    72    52   206
# 10   990   617  4.61  1000    77    82     6    75     1   100    43   157
# # … with 20 more rows
```


---
# Mutate


```r
denvM3 &lt;- denv %&gt;%
  select(dfs, alt, pH, nit, pho, amm) %&gt;%
  dplyr::filter(alt &gt; 400) %&gt;%
  mutate(pH2 = pH + 1) %&gt;%
  mutate(index = 2*nit + pho + amm)
denvM3
# # A tibble: 15 x 8
#      dfs   alt    pH   nit   pho   amm   pH2 index
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1     3   934    79    20     1     0    80    41
#  2    22   932    80    20     2    10    81    52
#  3   102   914    83    22     5     5    84    54
#  4   185   854    80    21    10     0    81    52
#  5   215   849    81    52    38    20    82   162
#  6   324   846    79    15    20     0    80    50
#  7   268   841    81    15     7     0    82    37
#  8   491   792    81    41    20    12    82   114
#  9   705   752    80    82    30    12    81   206
# 10   990   617    77    75     6     1    78   157
# 11  1234   483    81   160    30     0    82   350
# 12  1324   477    79    50     4     0    80   104
# 13  1436   450    81    52     6     0    82   110
# 14  1522   434    83   123    27     0    84   273
# 15  1645   415    86   100    40     0    87   240
```

---
# Mutate


```r
model &lt;- denv %&gt;%
  select(dfs, alt, pH, nit, pho, amm) %&gt;%
  dplyr::filter(alt &gt; 400) %&gt;%
  mutate(pH2 = pH + 1) %&gt;%
  mutate(index = 2*nit + pho + amm) %&gt;%
  lm(index ~ pH2, data = .)
summary(model)
# 
# Call:
# lm(formula = index ~ pH2, data = .)
# 
# Residuals:
#     Min      1Q  Median      3Q     Max 
# -117.64  -66.20  -23.96   54.46  212.04 
# 
# Coefficients:
#             Estimate Std. Error t value Pr(&gt;|t|)
# (Intercept) -1243.01     959.57  -1.295    0.218
# pH2            16.84      11.74   1.435    0.175
# 
# Residual standard error: 93.11 on 13 degrees of freedom
# Multiple R-squared:  0.1367,	Adjusted R-squared:  0.07033 
# F-statistic: 2.059 on 1 and 13 DF,  p-value: 0.1749
```

---
class: inverse, center, middle

# Questions?

## &lt;i class="fa fa-question-circle-o" aria-hidden="true"&gt;&lt;/i&gt;




---
# Join
&lt;br&gt;

--



```r
dfis &lt;- doubs$fish
head(denv, 4)
# # A tibble: 4 x 11
#     dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1     3   934  6.18    84    79    45     1    20     0   122    27
# 2    22   932  3.43   100    80    40     2    20    10   103    19
# 3   102   914  3.64   180    83    52     5    22     5   105    35
# 4   185   854  3.50   253    80    72    10    21     0   110    13
head(dfis, 4)
#   Cogo Satr Phph Neba Thth Teso Chna Chto Lele Lece Baba Spbi Gogo Eslu Pefl Rham Legi Scer
# 1    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
# 2    0    5    4    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0
# 3    0    5    5    5    0    0    0    0    0    0    0    0    0    1    0    0    0    0
# 4    0    4    5    5    0    0    0    0    0    1    0    0    1    2    2    0    0    0
#   Cyca Titi Abbr Icme Acce Ruru Blbj Alal Anan
# 1    0    0    0    0    0    0    0    0    0
# 2    0    0    0    0    0    0    0    0    0
# 3    0    0    0    0    0    0    0    0    0
# 4    0    1    0    0    0    0    0    0    0
```

---
# Join
&lt;br&gt;


```r
denv &lt;- denv %&gt;% mutate(idSite = 1:nrow(denv))
head(denv, 4)
# # A tibble: 4 x 12
#     dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo idSite
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;
# 1     3   934  6.18    84    79    45     1    20     0   122    27      1
# 2    22   932  3.43   100    80    40     2    20    10   103    19      2
# 3   102   914  3.64   180    83    52     5    22     5   105    35      3
# 4   185   854  3.50   253    80    72    10    21     0   110    13      4

dfis$idSite &lt;- 1:nrow(denv)
head(dfis, 4)
#   Cogo Satr Phph Neba Thth Teso Chna Chto Lele Lece Baba Spbi Gogo Eslu Pefl Rham Legi Scer
# 1    0    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
# 2    0    5    4    3    0    0    0    0    0    0    0    0    0    0    0    0    0    0
# 3    0    5    5    5    0    0    0    0    0    0    0    0    0    1    0    0    0    0
# 4    0    4    5    5    0    0    0    0    0    1    0    0    1    2    2    0    0    0
#   Cyca Titi Abbr Icme Acce Ruru Blbj Alal Anan idSite
# 1    0    0    0    0    0    0    0    0    0      1
# 2    0    0    0    0    0    0    0    0    0      2
# 3    0    0    0    0    0    0    0    0    0      3
# 4    0    1    0    0    0    0    0    0    0      4
```

---
# Join
&lt;br&gt;


```r
dmerg &lt;- denv %&gt;% inner_join(dfis)
head(dmerg)
# # A tibble: 6 x 39
#     dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo idSite  Cogo  Satr  Phph
#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
# 1     3   934  6.18    84    79    45     1    20     0   122    27      1     0     3     0
# 2    22   932  3.43   100    80    40     2    20    10   103    19      2     0     5     4
# 3   102   914  3.64   180    83    52     5    22     5   105    35      3     0     5     5
# 4   185   854  3.50   253    80    72    10    21     0   110    13      4     0     4     5
# 5   215   849  3.18   264    81    84    38    52    20    80    62      5     0     2     3
# 6   324   846  3.50   286    79    60    20    15     0   102    53      6     0     3     4
# # … with 24 more variables: Neba &lt;dbl&gt;, Thth &lt;dbl&gt;, Teso &lt;dbl&gt;, Chna &lt;dbl&gt;, Chto &lt;dbl&gt;,
# #   Lele &lt;dbl&gt;, Lece &lt;dbl&gt;, Baba &lt;dbl&gt;, Spbi &lt;dbl&gt;, Gogo &lt;dbl&gt;, Eslu &lt;dbl&gt;, Pefl &lt;dbl&gt;,
# #   Rham &lt;dbl&gt;, Legi &lt;dbl&gt;, Scer &lt;dbl&gt;, Cyca &lt;dbl&gt;, Titi &lt;dbl&gt;, Abbr &lt;dbl&gt;, Icme &lt;dbl&gt;,
# #   Acce &lt;dbl&gt;, Ruru &lt;dbl&gt;, Blbj &lt;dbl&gt;, Alal &lt;dbl&gt;, Anan &lt;dbl&gt;
dim(dmerg)
# [1] 30 39
```

---
# Join
&lt;br&gt;

### Different way of joining data frame [(see documentation)](https://dplyr.tidyverse.org/reference/join.html)



```r
dmerg1 &lt;- denv[-1,] %&gt;% inner_join(dfis[-2,])
dim(dmerg1)
# [1] 28 39
```

--


```r
dmerg2 &lt;- denv[-1,] %&gt;% right_join(dfis[-2,])
dmerg3 &lt;- denv[-1,] %&gt;% left_join(dfis[-2,])
dmerg4 &lt;- denv[-1,] %&gt;% full_join(dfis[-2,])
dim(dmerg2)
# [1] 29 39
dim(dmerg3)
# [1] 29 39
dim(dmerg4)
# [1] 30 39
```


---
# Aggregate
&lt;br&gt;

--


```r
denv2 &lt;- denv %&gt;% mutate(nit2 = nit &gt;=125)
denv2
# # A tibble: 30 x 13
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo idSite nit2 
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt; &lt;lgl&gt;
#  1     3   934  6.18    84    79    45     1    20     0   122    27      1 FALSE
#  2    22   932  3.43   100    80    40     2    20    10   103    19      2 FALSE
#  3   102   914  3.64   180    83    52     5    22     5   105    35      3 FALSE
#  4   185   854  3.50   253    80    72    10    21     0   110    13      4 FALSE
#  5   215   849  3.18   264    81    84    38    52    20    80    62      5 FALSE
#  6   324   846  3.50   286    79    60    20    15     0   102    53      6 FALSE
#  7   268   841  4.20   400    81    88     7    15     0   111    22      7 FALSE
#  8   491   792  3.26   130    81    94    20    41    12    70    81      8 FALSE
#  9   705   752  2.56   480    80    90    30    82    12    72    52      9 FALSE
# 10   990   617  4.61  1000    77    82     6    75     1   100    43     10 FALSE
# # … with 20 more rows
```

---
# Aggregate
&lt;br&gt;


```r
denv2$alt2 &lt;- "low"
denv2$alt2[denv2$alt&gt;450] &lt;- "medium"
denv2$alt2[denv2$alt&gt;750] &lt;- "high"
denv2$alt2 &lt;- as.factor(denv2$alt2)
denv2
# # A tibble: 30 x 14
#      dfs   alt   slo   flo    pH   har   pho   nit   amm   oxy   bdo idSite nit2  alt2  
#    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt; &lt;lgl&gt; &lt;fct&gt; 
#  1     3   934  6.18    84    79    45     1    20     0   122    27      1 FALSE high  
#  2    22   932  3.43   100    80    40     2    20    10   103    19      2 FALSE high  
#  3   102   914  3.64   180    83    52     5    22     5   105    35      3 FALSE high  
#  4   185   854  3.50   253    80    72    10    21     0   110    13      4 FALSE high  
#  5   215   849  3.18   264    81    84    38    52    20    80    62      5 FALSE high  
#  6   324   846  3.50   286    79    60    20    15     0   102    53      6 FALSE high  
#  7   268   841  4.20   400    81    88     7    15     0   111    22      7 FALSE high  
#  8   491   792  3.26   130    81    94    20    41    12    70    81      8 FALSE high  
#  9   705   752  2.56   480    80    90    30    82    12    72    52      9 FALSE high  
# 10   990   617  4.61  1000    77    82     6    75     1   100    43     10 FALSE medium
# # … with 20 more rows
```


---
# Aggregate
&lt;br&gt;


```r
denv2 %&gt;% group_by(nit2) %&gt;% summarize(n())
# # A tibble: 2 x 2
#   nit2  `n()`
#   &lt;lgl&gt; &lt;int&gt;
# 1 FALSE    14
# 2 TRUE     16
denv2 %&gt;% group_by(nit2, alt2) %&gt;% summarize(n())
# # A tibble: 5 x 3
# # Groups:   nit2 [?]
#   nit2  alt2   `n()`
#   &lt;lgl&gt; &lt;fct&gt;  &lt;int&gt;
# 1 FALSE high       9
# 2 FALSE low        3
# 3 FALSE medium     2
# 4 TRUE  low       15
# 5 TRUE  medium     1
```

---
# Aggregate
&lt;br&gt;


```r
denv2 %&gt;% group_by(nit2) %&gt;% summarize(n())
# # A tibble: 2 x 2
#   nit2  `n()`
#   &lt;lgl&gt; &lt;int&gt;
# 1 FALSE    14
# 2 TRUE     16
denv2 %&gt;% group_by(nit2, alt2) %&gt;%
  summarize(nb_obs = n(), mean_amm = mean(amm), sd_oxy = sd(oxy))
# # A tibble: 5 x 5
# # Groups:   nit2 [?]
#   nit2  alt2   nb_obs mean_amm sd_oxy
#   &lt;lgl&gt; &lt;fct&gt;   &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
# 1 FALSE high        9     6.56  18.6 
# 2 FALSE low         3     0      3.79
# 3 FALSE medium      2     0.5   15.6 
# 4 TRUE  low        15    37.9   20.6 
# 5 TRUE  medium      1     0     NA
```


---
# Write files

### Write data frames


```r
write.csv(dmerg, "output/dmerg.csv")
write_csv(dmerg, "output/dmerg2.csv")
```
--

### Write any R objects


```r
saveRDS(doubs, "output/doubs.rds")
# readRDS("output/dmerg.rds")
write_rds(doubs, "output/doubs.rds")
# read_rds
```







---
class: inverse, center, middle

# Data visualization

## &lt;i class="fa fa-bar-chart" aria-hidden="true"&gt;&lt;/i&gt;


---
# Data visualization
&lt;br&gt;

## [Material +](https://insileco.github.io/Visualisation-SentinelleNord/#1)

## [bookdown](https://bookdown.org/)


---
# Components
&lt;br&gt;

.pull-left[
- "a chart is worth a thousand words"
]

.pull-right[

&lt;img src="introKC_files/figure-html/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Components
&lt;br&gt;

.pull-left[
- "a chart is worth a thousand words"
- plot window
]

.pull-right[

&lt;img src="introKC_files/figure-html/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Components
&lt;br&gt;

.pull-left[
- "a chart is worth a thousand words"
- plot window
- plot region
]


.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-46-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Components
&lt;br&gt;

.pull-left[
- "a chart is worth a thousand words"
- plot window
- plot region
- data
]


.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-47-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Components
&lt;br&gt;

.pull-left[

- "a chart is worth a thousand words"
- plot window
- plot region
- data
- axes
]

.pull-right[

&lt;img src="introKC_files/figure-html/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Components
&lt;br&gt;

.pull-left[

- "a chart is worth a thousand words"
- plot window
- plot region
- data
- axes
- title
]


.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-49-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Components
&lt;br&gt;

.pull-left[
- "a chart is worth a thousand words"
- plot window
- plot region
- data
- axes
- titles
- legend
]


.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-50-1.png" style="display: block; margin: auto;" /&gt;
]




---
# graphics vs grid
&lt;br&gt;

.center[![:scale 80%](images/Murrell2015.jpg)]

Murrell, P. (2015) [The gridGraphics Package]("https://journal.r-project.org/archive/2015-1/murrell.pdf"). The R Jounal.


---
# Workflows


### Base plot

```R
dev(...)
par(...)
plot(...)
fun1(...)
fun2(...)
dev.off()
```

&lt;br&gt;

### ggplot2

```R
myplot &lt;- ggplot() + gg_XX1 + gg_XX2 + gg_XX3
myplot
ggsave(...)
```

---
# Hundreds of packages
&lt;br&gt;

### [List of packages](https://insileco.github.io/wiki/rgraphpkgs/)
### [r-graph-gallery](https://www.r-graph-gallery.com/)
### [data-to-viz](https://www.data-to-viz.com/)
### [Cookbook for R](http://www.cookbook-r.com/Graphs/)

---
# Basic plots

.pull-left[


```r
# denv as used above
plot(x = denv2$alt,
  y = denv2$amm)
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-51-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm)) +
  geom_point()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-52-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Basic plots

.pull-left[


```r
plot(x = denv2$alt,
  y = denv$amm,
  type = "l")
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm)) +
  geom_line()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-54-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Basic plots

.pull-left[


```r
par(las = 1)
plot(x = denv2$alt, y = denv$amm, type = "l",
    xlab = "altitude", ylab = "amm")
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-55-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm)) +
  geom_line()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-56-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Basic plots

.pull-left[


```r
par(las = 1)
plot(x = denv2$alt, y = denv$amm, type = "l",
  xlab = "altitude", ylab = "amm")
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-57-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm)) +
  geom_line() + xlab("altitude") + 
  theme_bw()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-58-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Basic plots

.pull-left[


```r
par(las = 1)
plot(x = denv2$alt, y = denv$amm, pch = 19,
  col = denv2$nit2)
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-59-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% ggplot(aes(x = alt, y = amm,
  colour = nit2)) + geom_point() + 
  xlab("altitude") + 
  theme_bw()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-60-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Basic plots



```r
colors()[1:50]
#  [1] "white"          "aliceblue"      "antiquewhite"   "antiquewhite1"  "antiquewhite2" 
#  [6] "antiquewhite3"  "antiquewhite4"  "aquamarine"     "aquamarine1"    "aquamarine2"   
# [11] "aquamarine3"    "aquamarine4"    "azure"          "azure1"         "azure2"        
# [16] "azure3"         "azure4"         "beige"          "bisque"         "bisque1"       
# [21] "bisque2"        "bisque3"        "bisque4"        "black"          "blanchedalmond"
# [26] "blue"           "blue1"          "blue2"          "blue3"          "blue4"         
# [31] "blueviolet"     "brown"          "brown1"         "brown2"         "brown3"        
# [36] "brown4"         "burlywood"      "burlywood1"     "burlywood2"     "burlywood3"    
# [41] "burlywood4"     "cadetblue"      "cadetblue1"     "cadetblue2"     "cadetblue3"    
# [46] "cadetblue4"     "chartreuse"     "chartreuse1"    "chartreuse2"    "chartreuse3"
library(RColorBrewer)
```

---
# Basic plots

.pull-left[


```r
par(las = 1)
plot(x = denv2$alt, y = denv$amm, pch = 19, 
     xlab = "altitude", ylab = "amm",
     col = c("salmon1", "turquoise2")[denv2$nit2+1], 
     cex = 2)
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-62-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm, colour = nit2)) +
  geom_point(size = 3) + 
  xlab("altitude") + theme_bw()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-63-1.png" style="display: block; margin: auto;" /&gt;
]



---
# Basic plots

.pull-left[


```r
par(las = 1, mar = c(4,4,1,1))
plot(x = denv2$alt, y = denv$amm, pch = 19, 
     xlab = "altitude", ylab = "amm",
  col = c("salmon1", "turquoise2")[denv2$nit2+1], 
  cex = 1.5)
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-64-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt, y = amm, colour = nit2)) +
  geom_point(size = 3) + xlab("altitude") + 
  theme_bw()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-65-1.png" style="display: block; margin: auto;" /&gt;
]



---
# Export your figure
&lt;br&gt;

```R
png("output/figb.png", unit = "in", width = 6, height = 5, res = 300)
par(las = 1, mar = c(4,4,1,1))
plot(x = denv2$alt, y = denv$amm, pch = 19, xlab = "altitude", ylab = "amm",
  col = c("salmon1", "turquoise2")[denv2$nit2+1], cex = 1.5)
dev.off()
```

---
# Export your figure
&lt;br&gt;

```R
p &lt;- denv2 %&gt;% ggplot(aes(x = alt, y = amm, colour = nit2)) +
  geom_point(size = 3) + xlab("altitude") + theme_bw()
ggsave("output/figg.png", unit = "in", width = 6, height = 5)
```


---
# Hints
&lt;br&gt;

### Base plots

- remove all components and add one layer at a time
- use `?par` as well as the help of the functions you'll use

&lt;br&gt;

### ggplot2

- https://ggplot2.tidyverse.org/
- find the geom (`gg_XXX`) you need: [ggplot2 extensions](https://www.ggplot2-exts.org/)


---
# Other graphs?
&lt;br&gt;

## [Cookbook for R](http://www.cookbook-r.com/Graphs/)

## [r-graph-gallery](https://www.r-graph-gallery.com/)


---
# Boxplots

`amm` vs in `denv2`

--

### Baseplot

- `boxplot()`
- `par()`

--

### ggplot2

- `geom_boxplot()`


---
# Boxplots

.pull-left[


```r
par(las = 1)
boxplot(oxy~alt2, data = denv2)
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-66-1.png" style="display: block; margin: auto;" /&gt;
]


.pull-right[

```r
p &lt;- denv2 %&gt;% 
  ggplot(aes(x = alt2, y = oxy)) + 
  geom_boxplot()
p
```

&lt;img src="introKC_files/figure-html/unnamed-chunk-67-1.png" style="display: block; margin: auto;" /&gt;
]



---
# Custom plot
&lt;br&gt;

- Let's create a 3-panels figure


```r
mat &lt;- matrix(c(1,1,2,3), 2, 2)
mat
#      [,1] [,2]
# [1,]    1    2
# [2,]    1    3
```


---
# Custom plot - 3 panels
&lt;br&gt;

.pull-left[
```R
layout(mat, widths = c(1.5, 1))
layout.show(3)
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-69-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Custom plot - 3 panels
&lt;br&gt;

.pull-left[
```R
layout(mat, widths = c(1.1, 1))
par(las = 1, mar = c(4,4,1,1))
#-- Panel 1
plot(1,1)
#-- Panel 2
plot(x = denv2$alt, y = denv$amm,
  pch = 19, xlab = "altitude", ylab = "amm",
  col = c("salmon1", "turquoise2")[denv2$nit2+1], cex = 1.2)
#--  Panel 3
boxplot(amm~alt2, data = denv2, ylim = c(0, 80))
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-70-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Custom plot - Panel 1


.pull-left[
```R
plot(denv2$pho, -denv2$alt)
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-71-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Custom plot - Panel 1


.pull-left[
```R
par(las = 1, bty = "l")
plot(denv2$pho, -denv2$alt,
  ann = FALSE, axes = FALSE,
  type = "n")
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-72-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Custom plot - Panel 1


.pull-left[
```R
par(las = 1, bty = "l")
plot(denv2$pho, -denv2$alt,
  ann = FALSE, axes = FALSE,
  type = "n", xlim = c(0, 500),
  ylim = c(-1000, 0))
points(denv2$pho, -denv2$alt,
  pch = 19, cex = 1.1)
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-73-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Custom plot - Panel 1


.pull-left[
```R
par(las = 1, bty = "l")
plot(denv2$pho, -denv2$alt,
  ann = FALSE, axes = FALSE,
  type = "n", xlim = c(0, 500),
  ylim = c(-1000, 0))
lines(denv2$pho, -denv2$alt,
  lwd = 1.5)
axis(1)
axis(2, at = seq(-1000, 0, 200),
labels = abs(seq(-1000, 0, 200)))
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-74-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Custom plot - Panel 1


.pull-left[
```R
par(las = 1, bty = "l")
plot(denv2$pho, -denv2$alt,
  ann = FALSE, axes = FALSE,
  type = "n", xlim = c(0, 500),
  ylim = c(-1000, 0))
lines(denv2$pho, -denv2$alt,
  lwd = 1.5)
axis(1)
axis(2, at = seq(-1000, 0, 200),
labels = abs(seq(-1000, 0, 200)))
title(main = "A",
  xlab = "Phosphorous",
  ylab = "Altitude")
```
]

.pull-right[
&lt;img src="introKC_files/figure-html/unnamed-chunk-75-1.png" style="display: block; margin: auto;" /&gt;
]



---
# Custom plot



```r
png("output/figure1.png", unit = "in", width = 7, height = 6, res = 300)
layout(mat, widths = c(1.2, 1))
par(mar = c(4,4,1,1))
#-- Panel 1
par(las = 1, bty = "l", xaxs = "i", yaxs = "i")
plot(denv2$pho, -denv2$alt, ann = FALSE, axes = FALSE, type = "n", xlim = c(0, 500),
ylim = c(-1000, -100))
lines(denv2$pho, -denv2$alt, lwd = 1.5)
axis(1)
axis(2, at = seq(-1000, 0, 200),
labels = abs(seq(-1000, 0, 200)))
title(main = "A", xlab = "Phosphorous", ylab = "Altitude")
#-- Panel 2
par(bty = "o", xaxs = "r", yaxs = "r")
plot(x = denv2$alt, y = denv$amm, pch = 19,
  xlab = "altitude", ylab = "amm",
  col = c("salmon1", "turquoise2")[denv2$nit2+1],
  cex = 1.5)
#--  Panel 3
boxplot(oxy~alt2, data = denv2)
```

---
# Custom plot

.center[![:scale 80%](output/figure1.png)]



---
# Custom plot
&lt;br&gt;

- Another example: https://insileco.github.io/Visualisation-SentinelleNord/#33

- See https://insileco.github.io/VisualiseR/

- Partition with ggplot2

  - [article on sthda](http://www.sthda.com/english/wiki/ggplot2-facet-split-a-plot-into-a-matrix-of-panels)
  - [see patchwork](https://github.com/thomasp85/patchwork)
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="inSileco-macros.js"></script>
<script>var slideshow = remark.create({
"highlightLines": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
